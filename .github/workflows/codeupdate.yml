name: Sync Code base
on:
  push:
    branches:
      - master

jobs:
  update-code:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Set Up SSH
      run: |
        echo "$SSH_PRIVATE_KEY" > ~/.ssh/id_rsa
        chmod 600 ~/.ssh/id_rsa
    - name: Pull Code
      run: |
        sshpass -p ${{ secrets.VM_PASSWORD }} ssh ${{ secrets.VM_USERNAME }}@${{ secrets.VM_IP_ADDRESS }} 'cd /Assessment/nodejs-webapp && git pull'
